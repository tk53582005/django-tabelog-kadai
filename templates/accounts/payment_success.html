{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}æ±ºæ¸ˆå®Œäº† - NAGOYAMESHI{% endblock %}

{% block extra_css %}
<style>
    .success-container {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        min-height: 50vh;
        display: flex;
        align-items: center;
        margin: -20px -15px 40px -15px;
    }

    .success-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        color: #333;
        text-align: center;
    }

    .success-icon {
        font-size: 4rem;
        color: #28a745;
        margin-bottom: 20px;
        animation: checkmark 0.6s ease;
    }

    @keyframes checkmark {
        0% { transform: scale(0); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }

    .next-steps {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 30px;
        margin-top: 40px;
    }

    .step-item {
        background: white;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        transition: transform 0.2s ease;
    }

    .step-item:hover {
        transform: translateX(10px);
    }

    .step-number {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 20px;
        flex-shrink: 0;
    }

    .subscription-details {
        background: linear-gradient(135deg, #f8f9ff 0%, #fff5f5 100%);
        border-radius: 15px;
        padding: 25px;
        margin: 30px 0;
        border-left: 5px solid #007bff;
    }

    .btn-action {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
        text-decoration: none;
        display: inline-block;
    }

    .btn-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.6);
        color: white;
    }

    .celebration {
        position: relative;
        overflow: hidden;
    }

    .celebration::before {
        content: 'ğŸ‰';
        position: absolute;
        font-size: 2rem;
        animation: confetti 3s infinite;
        opacity: 0.7;
    }

    .celebration::after {
        content: 'âœ¨';
        position: absolute;
        font-size: 1.5rem;
        animation: confetti 3s infinite 0.5s;
        right: 10%;
        opacity: 0.7;
    }

    @keyframes confetti {
        0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(100px) rotate(360deg); opacity: 0; }
    }
</style>
{% endblock %}

{% block content %}
<div class="success-container celebration">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="success-card">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    
                    <h1 class="h2 mb-3">ğŸ‰ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ç™»éŒ²å®Œäº†ï¼</h1>
                    <p class="lead mb-4">
                        ã”æ±ºæ¸ˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼<br>
                        NAGOYAMESHIãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã¨ã—ã¦ã€ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚
                    </p>

                    {% if session %}
                    <div class="subscription-details">
                        <h5><i class="fas fa-crown text-warning me-2"></i>ã”å¥‘ç´„å†…å®¹</h5>
                        <div class="row text-start">
                            <div class="col-sm-6">
                                <strong>ãƒ—ãƒ©ãƒ³:</strong> ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡
                            </div>
                            <div class="col-sm-6">
                                <strong>æœˆé¡æ–™é‡‘:</strong> Â¥300
                            </div>
                            <div class="col-sm-6">
                                <strong>æ±ºæ¸ˆæ–¹æ³•:</strong> ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰
                            </div>
                            <div class="col-sm-6">
                                <strong>æ¬¡å›æ›´æ–°:</strong> 
                                {% if subscription %}
                                    {{ subscription.current_period_end|date:"Yå¹´mæœˆdæ—¥" }}
                                {% else %}
                                    1ãƒ¶æœˆå¾Œ
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <div class="next-steps">
                        <h5 class="mb-4"><i class="fas fa-lightbulb text-warning me-2"></i>ä»Šã™ãã§ãã‚‹ã“ã¨</h5>
                        
                        <div class="step-item">
                            <div class="step-number">1</div>
                            <div>
                                <h6 class="mb-1">ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’äºˆç´„ã—ã‚ˆã†</h6>
                                <small class="text-muted">ãŠæ°—ã«å…¥ã‚Šã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’è¦‹ã¤ã‘ã¦äºˆç´„ã—ã¦ã¿ã¾ã—ã‚‡ã†</small>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div>
                                <h6 class="mb-1">ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ã—ã‚ˆã†</h6>
                                <small class="text-muted">è¨ªå•ã—ãŸãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®æ„Ÿæƒ³ã‚’ã‚·ã‚§ã‚¢ã—ã¾ã—ã‚‡ã†</small>
                            </div>
                        </div>

                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div>
                                <h6 class="mb-1">ãŠæ°—ã«å…¥ã‚Šã‚’ç„¡åˆ¶é™ç™»éŒ²</h6>
                                <small class="text-muted">æ°—ã«ãªã‚‹ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ã©ã‚“ã©ã‚“ä¿å­˜ã—ã¾ã—ã‚‡ã†</small>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <a href="{% url 'restaurants:index' %}" class="btn-action me-3">
                            <i class="fas fa-utensils me-2"></i>ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’æ¢ã™
                        </a>
                        <a href="{% url 'accounts:mypage' %}" class="btn btn-outline-primary">
                            <i class="fas fa-user me-2"></i>ãƒã‚¤ãƒšãƒ¼ã‚¸
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã®èª¬æ˜ -->
<div class="container mb-5">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <h3 class="text-center mb-4">
                <i class="fas fa-star text-warning me-2"></i>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã®ã”ç´¹ä»‹
            </h3>
            
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-calendar-check fa-3x text-primary mb-3"></i>
                            <h5>ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³äºˆç´„</h5>
                            <p class="text-muted">
                                ãŠæ°—ã«å…¥ã‚Šã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ç°¡å˜ã«äºˆç´„ã€‚
                                äºˆç´„å±¥æ­´ã®ç®¡ç†ã‚‚ã§ãã¾ã™ã€‚
                            </p>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-edit fa-3x text-success mb-3"></i>
                            <h5>ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ãƒ»ç·¨é›†</h5>
                            <p class="text-muted">
                                ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ãƒ»ç·¨é›†ã€‚
                                ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨æƒ…å ±ã‚’ã‚·ã‚§ã‚¢ã—ã¾ã—ã‚‡ã†ã€‚
                            </p>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-heart fa-3x text-danger mb-3"></i>
                            <h5>ç„¡åˆ¶é™ãŠæ°—ã«å…¥ã‚Š</h5>
                            <p class="text-muted">
                                æ°—ã«ãªã‚‹ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ç„¡åˆ¶é™ã«
                                ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã§ãã¾ã™ã€‚
                            </p>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body text-center">
                            <i class="fas fa-search-plus fa-3x text-info mb-3"></i>
                            <h5>è©³ç´°æ¤œç´¢</h5>
                            <p class="text-muted">
                                ä¾¡æ ¼å¸¯ã€è©•ä¾¡ã€è·é›¢ãªã©
                                è©³ç´°ãªæ¡ä»¶ã§æ¤œç´¢ã§ãã¾ã™ã€‚
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ã‚µãƒãƒ¼ãƒˆæƒ…å ± -->
<div class="bg-light py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h4 class="mb-3">
                    <i class="fas fa-headset text-primary me-2"></i>ã‚µãƒãƒ¼ãƒˆã«ã¤ã„ã¦
                </h4>
                <p class="mb-4">
                    ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚<br>
                    ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡æ§˜ã«ã¯å„ªå…ˆã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã„ãŸã—ã¾ã™ã€‚
                </p>
                <div>
                    <a href="{% url 'accounts:subscription_manage' %}" class="btn btn-outline-primary me-2">
                        <i class="fas fa-cog me-1"></i>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†
                    </a>
                    <a href="mailto:support@nagoyameshi.com" class="btn btn-outline-secondary">
                        <i class="fas fa-envelope me-1"></i>ã‚µãƒãƒ¼ãƒˆã«é€£çµ¡
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// æˆåŠŸãƒšãƒ¼ã‚¸ã®è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
setTimeout(function() {
    // 10ç§’å¾Œã«ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’å¼·èª¿
    const buttons = document.querySelectorAll('.btn-action');
    buttons.forEach(btn => {
        btn.style.animation = 'pulse 1s infinite';
    });
}, 10000);

// ç¥ç¦åŠ¹æœ
document.addEventListener('DOMContentLoaded', function() {
    // 3ç§’å¾Œã«è¿½åŠ ã®ç¥ç¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    setTimeout(function() {
        if (!sessionStorage.getItem('celebrationShown')) {
            sessionStorage.setItem('celebrationShown', 'true');
            
            // ç°¡å˜ãªé€šçŸ¥
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div class="alert alert-success alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999; max-width: 300px;">
                    <strong>ğŸŠ ã‚ˆã†ã“ããƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ï¼</strong><br>
                    ç´ æ™´ã‚‰ã—ã„ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ä½“é¨“ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ï¼
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            document.body.appendChild(notification);
            
            // 5ç§’å¾Œã«è‡ªå‹•ã§æ¶ˆã™
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
    }, 3000);
});
</script>
{% endblock %}